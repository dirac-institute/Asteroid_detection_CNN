Index: notebooks/Inspect_model.ipynb
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>{\n \"cells\": [\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"id\": \"380ea93d\",\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"!fuser -k /dev/nvidia0\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 1,\n   \"id\": \"d3158a83\",\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"!nvidia-smi\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 4,\n   \"id\": \"d62a2e77\",\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"import sys\\n\",\n    \"sys.path.append(\\\"..\\\")\\n\",\n    \"import tools\\n\",\n    \"import evals\\n\",\n    \"import matplotlib.pyplot as plt\\n\",\n    \"import numpy as np\\n\",\n    \"from lsst.daf.butler import Butler\\n\",\n    \"import matplotlib as mpl\\n\",\n    \"%load_ext autoreload\\n\",\n    \"%autoreload 2\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 5,\n   \"id\": \"0d66a43d\",\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"#model_path = \\\"../DATA/Trained_model_0.keras\\\"\\n\",\n    \"model_path = \\\"../DATA/test_model_delete.keras\\\"\\n\",\n    \"tf_dataset_path = \\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/DATA/\\\"\\n\",\n    \"collection = \\\"u/kmrakovc/\\\"\\n\",\n    \"val_index_path=\\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/DATA/val_index1.npy\\\"\\n\",\n    \"repo_path =\\\"/epyc/ssd/users/kmrakovc/DATA/rc2_subset/SMALL_HSC/\\\"\\n\",\n    \"threshold = 0.1\\n\",\n    \"batch_size=10\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 6,\n   \"id\": \"5e28966e\",\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"def get_magnitude_bin (repo, output_coll):\\n\",\n    \"    butler = Butler(repo)\\n\",\n    \"    injection_catalog_ids = list(butler.registry.queryDatasets(\\\"injected_postISRCCD_catalog\\\", collections=output_coll, instrument='HSC'))\\n\",\n    \"    min_mag = 100\\n\",\n    \"    max_mag = 0\\n\",\n    \"    for injection_catalog_id in injection_catalog_ids:\\n\",\n    \"        injection_catalog= butler.get(\\\"injected_postISRCCD_catalog\\\", \\n\",\n    \"                                      dataId=injection_catalog_id.dataId, \\n\",\n    \"                                      collections=output_coll,)\\n\",\n    \"        magnitudes = injection_catalog[\\\"mag\\\"]\\n\",\n    \"        min_mag = min (min_mag, injection_catalog[\\\"mag\\\"].min())\\n\",\n    \"        max_mag = max (max_mag, injection_catalog[\\\"mag\\\"].max())\\n\",\n    \"    return min_mag, max_mag\\n\",\n    \"    \\n\",\n    \"\\n\",\n    \"def plot_trail_histogram (NN_data, LSST_data, true_data=None):\\n\",\n    \"    fig, ax = plt.subplots()\\n\",\n    \"    bins = np.arange(4, 74, 5)\\n\",\n    \"    if true_data is not None:\\n\",\n    \"        ax.hist(true_data, bins=bins, histtype=\\\"step\\\", label=\\\"True asteroids\\\")\\n\",\n    \"    ax.hist(NN_data, bins=bins, histtype=\\\"step\\\", label=\\\"NN detected asteroids\\\")\\n\",\n    \"    ax.hist(LSST_data, bins=bins, histtype=\\\"step\\\", label=\\\"LSST stack detected asteroids\\\")\\n\",\n    \"    ax.set_xlabel(\\\"Trail length\\\")\\n\",\n    \"    ax.set_ylabel(\\\"Count\\\")\\n\",\n    \"    ax.legend()\\n\",\n    \"    return fig\\n\",\n    \"\\n\",\n    \"def plot_magnitude_histogram (NN_data, LSST_data, true_data=None):\\n\",\n    \"    fig, ax = plt.subplots()\\n\",\n    \"    bins=np.arange(20,25.5,0.5)\\n\",\n    \"    if true_data is not None:\\n\",\n    \"        ax.hist(true_data, bins=bins, histtype=\\\"step\\\", label=\\\"True asteroids\\\")\\n\",\n    \"    ax.hist(NN_data, bins=bins, histtype=\\\"step\\\", label=\\\"NN detected asteroids\\\")\\n\",\n    \"    ax.hist(LSST_data, bins=bins, histtype=\\\"step\\\", label=\\\"LSST stack detected asteroids\\\")\\n\",\n    \"    ax.set_xlabel(\\\"Magnitude\\\")\\n\",\n    \"    ax.set_ylabel(\\\"Count\\\")\\n\",\n    \"    ax.legend()\\n\",\n    \"    return fig\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 7,\n   \"id\": \"1ea95340\",\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"def plot_mask_on_axis (mask, ax):\\n\",\n    \"    cmap = mpl.colors.ListedColormap(['white', 'green', 'cyan', 'red'])\\n\",\n    \"    ax.imshow(mask, cmap=cmap, interpolation='nearest')\\n\",\n    \"    ax.set_xticks([])\\n\",\n    \"    ax.set_yticks([])\\n\",\n    \"    labels = {0:'True Negative', 1:'True Positive', 2:'False Positive', 3:\\\"False Negative\\\"}    \\n\",\n    \"    patches =[mpl.patches.Patch(color=cmap.colors[i],label=labels[i]) for i in range(len(cmap.colors))]\\n\",\n    \"    ax.legend(handles=patches)\\n\",\n    \"    return ax\\n\",\n    \"\\n\",\n    \"def plot_input_on_axis (img, ax):\\n\",\n    \"    ax.imshow(img, cmap=\\\"grey\\\")\\n\",\n    \"    ax.set_xticks([])\\n\",\n    \"    ax.set_yticks([])\\n\",\n    \"    return ax\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 8,\n   \"id\": \"370d6a3a\",\n   \"metadata\": {\n    \"scrolled\": true\n   },\n   \"outputs\": [\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"No GPU detected\\n\",\n      \"30/30 [==============================] - 61s 2s/step\\n\",\n      \"30/30 [==============================] - 57s 2s/step\\n\",\n      \"30/30 [==============================] - 51s 2s/step\\n\",\n      \"30/30 [==============================] - 57s 2s/step\\n\",\n      \"NN  prediction created\\n\"\n     ]\n    }\n   ],\n   \"source\": [\n    \"predictions_1, predictions_2, \\\\\\n\",\n    \"predictions_3, predictions_4 = evals.eval_tools.create_NN_prediction ([tf_dataset_path+\\\"test1.tfrecord\\\",\\n\",\n    \"                                                                       tf_dataset_path+\\\"test2.tfrecord\\\",\\n\",\n    \"                                                                       tf_dataset_path+\\\"test3.tfrecord\\\",\\n\",\n    \"                                                                       tf_dataset_path+\\\"test4.tfrecord\\\"],\\n\",\n    \"                                                                      model_path,\\n\",\n    \"                                                                      threshold=threshold)\\n\",\n    \"print (\\\"NN  prediction created\\\")\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 10,\n   \"id\": \"fc5df5bd\",\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"Process ForkPoolWorker-20:\\n\",\n      \"Process ForkPoolWorker-12:\\n\",\n      \"Process ForkPoolWorker-11:\\n\",\n      \"Process ForkPoolWorker-13:\\n\",\n      \"Process ForkPoolWorker-16:\\n\",\n      \"Process ForkPoolWorker-18:\\n\",\n      \"Process ForkPoolWorker-17:\\n\",\n      \"Process ForkPoolWorker-19:\\n\",\n      \"Process ForkPoolWorker-14:\\n\",\n      \"Exception ignored in: <bound method IPythonKernel._clean_thread_parent_frames of <ipykernel.ipkernel.IPythonKernel object at 0x7fd9e2701250>>\\n\",\n      \"Traceback (most recent call last):\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/site-packages/ipykernel/ipkernel.py\\\", line 794, in _clean_thread_parent_frames\\n\",\n      \"    for identity in list(thread_to_parent_header.keys()):\\n\",\n      \"  Traceback (most recent call last):\\n\",\n      \"Traceback (most recent call last):\\n\",\n      \" Traceback (most recent call last):\\n\",\n      \"Traceback (most recent call last):\\n\",\n      \"Traceback (most recent call last):\\n\",\n      \"Traceback (most recent call last):\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/process.py\\\", line 314, in _bootstrap\\n\",\n      \"    self.run()\\n\",\n      \"Traceback (most recent call last):\\n\",\n      \"Traceback (most recent call last):\\n\",\n      \"Traceback (most recent call last):\\n\",\n      \"   File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/process.py\\\", line 314, in _bootstrap\\n\",\n      \"    self.run()\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/process.py\\\", line 314, in _bootstrap\\n\",\n      \"    self.run()\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/process.py\\\", line 314, in _bootstrap\\n\",\n      \"    self.run()\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/process.py\\\", line 314, in _bootstrap\\n\",\n      \"    self.run()\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/process.py\\\", line 108, in run\\n\",\n      \"    self._target(*self._args, **self._kwargs)\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/process.py\\\", line 314, in _bootstrap\\n\",\n      \"    self.run()\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/process.py\\\", line 314, in _bootstrap\\n\",\n      \"    self.run()\\n\",\n      \"   File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/process.py\\\", line 108, in run\\n\",\n      \"    self._target(*self._args, **self._kwargs)\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/process.py\\\", line 314, in _bootstrap\\n\",\n      \"    self.run()\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/process.py\\\", line 108, in run\\n\",\n      \"    self._target(*self._args, **self._kwargs)\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/process.py\\\", line 108, in run\\n\",\n      \"    self._target(*self._args, **self._kwargs)\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/process.py\\\", line 108, in run\\n\",\n      \"    self._target(*self._args, **self._kwargs)\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/process.py\\\", line 314, in _bootstrap\\n\",\n      \"    self.run()\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/process.py\\\", line 108, in run\\n\",\n      \"    self._target(*self._args, **self._kwargs)\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/process.py\\\", line 108, in run\\n\",\n      \"    self._target(*self._args, **self._kwargs)\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py\\\", line 125, in worker\\n\",\n      \"    result = (True, func(*args, **kwds))\\n\",\n      \"                    ^^^^^^^^^^^^^^^^^^^\\n\",\n      \"   File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/process.py\\\", line 108, in run\\n\",\n      \"    self._target(*self._args, **self._kwargs)\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py\\\", line 125, in worker\\n\",\n      \"    result = (True, func(*args, **kwds))\\n\",\n      \"                    ^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py\\\", line 125, in worker\\n\",\n      \"    result = (True, func(*args, **kwds))\\n\",\n      \"                    ^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py\\\", line 125, in worker\\n\",\n      \"    result = (True, func(*args, **kwds))\\n\",\n      \"                    ^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py\\\", line 125, in worker\\n\",\n      \"    result = (True, func(*args, **kwds))\\n\",\n      \"                    ^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py\\\", line 51, in starmapstar\\n\",\n      \"    return list(itertools.starmap(args[0], args[1]))\\n\",\n      \"           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py\\\", line 125, in worker\\n\",\n      \"    result = (True, func(*args, **kwds))\\n\",\n      \"                    ^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py\\\", line 125, in worker\\n\",\n      \"    result = (True, func(*args, **kwds))\\n\",\n      \"                    ^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/process.py\\\", line 108, in run\\n\",\n      \"    self._target(*self._args, **self._kwargs)\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py\\\", line 125, in worker\\n\",\n      \"    result = (True, func(*args, **kwds))\\n\",\n      \"                    ^^^^^^^^^^^^^^^^^^^\\n\",\n      \"   File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py\\\", line 51, in starmapstar\\n\",\n      \"    return list(itertools.starmap(args[0], args[1]))\\n\",\n      \"           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py\\\", line 51, in starmapstar\\n\",\n      \"    return list(itertools.starmap(args[0], args[1]))\\n\",\n      \"           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py\\\", line 51, in starmapstar\\n\",\n      \"    return list(itertools.starmap(args[0], args[1]))\\n\",\n      \"           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py\\\", line 216, in get_one_image_mask\\n\",\n      \"    mask_p, visited = FDS(p_img, (roots[0][0], roots[1][0]), pixel_gap, visited_pixels=visited)\\n\",\n      \"                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py\\\", line 51, in starmapstar\\n\",\n      \"    return list(itertools.starmap(args[0], args[1]))\\n\",\n      \"           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py\\\", line 51, in starmapstar\\n\",\n      \"    return list(itertools.starmap(args[0], args[1]))\\n\",\n      \"           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py\\\", line 51, in starmapstar\\n\",\n      \"    return list(itertools.starmap(args[0], args[1]))\\n\",\n      \"           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py\\\", line 125, in worker\\n\",\n      \"    result = (True, func(*args, **kwds))\\n\",\n      \"                    ^^^^^^^^^^^^^^^^^^^\\n\",\n      \"   File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py\\\", line 51, in starmapstar\\n\",\n      \"    return list(itertools.starmap(args[0], args[1]))\\n\",\n      \"           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py\\\", line 216, in get_one_image_mask\\n\",\n      \"    mask_p, visited = FDS(p_img, (roots[0][0], roots[1][0]), pixel_gap, visited_pixels=visited)\\n\",\n      \"                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n\"\n     ]\n    },\n    {\n     \"name\": \"stderr\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"  File \\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py\\\", line 216, in get_one_image_mask\\n\",\n      \"    mask_p, visited = FDS(p_img, (roots[0][0], roots[1][0]), pixel_gap, visited_pixels=visited)\\n\",\n      \"                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py\\\", line 216, in get_one_image_mask\\n\",\n      \"    mask_p, visited = FDS(p_img, (roots[0][0], roots[1][0]), pixel_gap, visited_pixels=visited)\\n\",\n      \"                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py\\\", line 199, in FDS\\n\",\n      \"    for ii in range(i_min, i_max):\\n\",\n      \"  File \\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py\\\", line 216, in get_one_image_mask\\n\",\n      \"    mask_p, visited = FDS(p_img, (roots[0][0], roots[1][0]), pixel_gap, visited_pixels=visited)\\n\",\n      \"                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py\\\", line 216, in get_one_image_mask\\n\",\n      \"    mask_p, visited = FDS(p_img, (roots[0][0], roots[1][0]), pixel_gap, visited_pixels=visited)\\n\",\n      \"                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py\\\", line 216, in get_one_image_mask\\n\",\n      \"    mask_p, visited = FDS(p_img, (roots[0][0], roots[1][0]), pixel_gap, visited_pixels=visited)\\n\",\n      \"                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py\\\", line 51, in starmapstar\\n\",\n      \"    return list(itertools.starmap(args[0], args[1]))\\n\",\n      \"           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n\",\n      \"   File \\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py\\\", line 216, in get_one_image_mask\\n\",\n      \"    mask_p, visited = FDS(p_img, (roots[0][0], roots[1][0]), pixel_gap, visited_pixels=visited)\\n\",\n      \"                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n\",\n      \"  File \\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py\\\", line 201, in FDS\\n\",\n      \"    todo.append((jj, ii))\\n\",\n      \"  File \\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py\\\", line None, in FDS\\n\",\n      \"KeyboardInterrupt\\n\",\n      \"  File \\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py\\\", line 201, in FDS\\n\",\n      \"    todo.append((jj, ii))\\n\",\n      \"  File \\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py\\\", line None, in FDS\\n\",\n      \"  File \\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py\\\", line 201, in FDS\\n\",\n      \"    todo.append((jj, ii))\\n\",\n      \"  File \\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py\\\", line None, in FDS\\n\",\n      \"  File \\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py\\\", line 216, in get_one_image_mask\\n\",\n      \"    mask_p, visited = FDS(p_img, (roots[0][0], roots[1][0]), pixel_gap, visited_pixels=visited)\\n\",\n      \"                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n\",\n      \"   File \\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py\\\", line 201, in FDS\\n\",\n      \"    todo.append((jj, ii))\\n\",\n      \"KeyboardInterrupt\\n\",\n      \"KeyboardInterrupt\\n\",\n      \"KeyboardInterrupt\\n\",\n      \"KeyboardInterrupt\\n\",\n      \"KeyboardInterrupt\\n\",\n      \"   File \\\"/astro/users/kmrakovc/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py\\\", line 201, in FDS\\n\",\n      \"    todo.append((jj, ii))\\n\",\n      \"KeyboardInterrupt\\n\",\n      \"KeyboardInterrupt\\n\",\n      \"KeyboardInterrupt\\n\",\n      \"              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n\",\n      \"KeyboardInterrupt: \\n\"\n     ]\n    },\n    {\n     \"ename\": \"KeyboardInterrupt\",\n     \"evalue\": \"\",\n     \"output_type\": \"error\",\n     \"traceback\": [\n      \"\\u001b[0;31m---------------------------------------------------------------------------\\u001b[0m\",\n      \"\\u001b[0;31mKeyboardInterrupt\\u001b[0m                         Traceback (most recent call last)\",\n      \"Cell \\u001b[0;32mIn[10], line 2\\u001b[0m\\n\\u001b[1;32m      1\\u001b[0m inputs1, truths \\u001b[38;5;241m=\\u001b[39m tools\\u001b[38;5;241m.\\u001b[39mdata\\u001b[38;5;241m.\\u001b[39mcreate_XY_pairs (tf_dataset_path\\u001b[38;5;241m+\\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\u001b[38;5;124mtest1.tfrecord\\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m)\\n\\u001b[0;32m----> 2\\u001b[0m tp1, fp1, fn1, mask1 \\u001b[38;5;241m=\\u001b[39m \\u001b[43mevals\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43meval_tools\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mget_mask\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mtruths\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mpredictions_1\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mmultiprocess_size\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mbatch_size\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m      3\\u001b[0m \\u001b[38;5;28mprint\\u001b[39m (\\u001b[38;5;124m\\\"\\u001b[39m\\u001b[38;5;124mScoring 1 done\\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m)\\n\\u001b[1;32m      5\\u001b[0m inputs2, truths \\u001b[38;5;241m=\\u001b[39m tools\\u001b[38;5;241m.\\u001b[39mdata\\u001b[38;5;241m.\\u001b[39mcreate_XY_pairs (tf_dataset_path\\u001b[38;5;241m+\\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\u001b[38;5;124mtest2.tfrecord\\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m)\\n\",\n      \"File \\u001b[0;32m~/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py:239\\u001b[0m, in \\u001b[0;36mget_mask\\u001b[0;34m(truths, predictions, multiprocess_size)\\u001b[0m\\n\\u001b[1;32m    237\\u001b[0m     parameters \\u001b[38;5;241m=\\u001b[39m [(truths[i], predictions[i]) \\u001b[38;5;28;01mfor\\u001b[39;00m i \\u001b[38;5;129;01min\\u001b[39;00m \\u001b[38;5;28mrange\\u001b[39m(truths\\u001b[38;5;241m.\\u001b[39mshape[\\u001b[38;5;241m0\\u001b[39m])]\\n\\u001b[1;32m    238\\u001b[0m     \\u001b[38;5;28;01mwith\\u001b[39;00m multiprocessing\\u001b[38;5;241m.\\u001b[39mPool(multiprocess_size) \\u001b[38;5;28;01mas\\u001b[39;00m pool:\\n\\u001b[0;32m--> 239\\u001b[0m         results \\u001b[38;5;241m=\\u001b[39m \\u001b[43mpool\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mstarmap\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mget_one_image_mask\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mparameters\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    240\\u001b[0m \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[1;32m    241\\u001b[0m     results \\u001b[38;5;241m=\\u001b[39m [\\u001b[38;5;28;01mNone\\u001b[39;00m] \\u001b[38;5;241m*\\u001b[39m truths\\u001b[38;5;241m.\\u001b[39mshape[\\u001b[38;5;241m0\\u001b[39m]\\n\",\n      \"File \\u001b[0;32m~/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py:375\\u001b[0m, in \\u001b[0;36mPool.starmap\\u001b[0;34m(self, func, iterable, chunksize)\\u001b[0m\\n\\u001b[1;32m    369\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21mstarmap\\u001b[39m(\\u001b[38;5;28mself\\u001b[39m, func, iterable, chunksize\\u001b[38;5;241m=\\u001b[39m\\u001b[38;5;28;01mNone\\u001b[39;00m):\\n\\u001b[1;32m    370\\u001b[0m \\u001b[38;5;250m    \\u001b[39m\\u001b[38;5;124;03m'''\\u001b[39;00m\\n\\u001b[1;32m    371\\u001b[0m \\u001b[38;5;124;03m    Like `map()` method but the elements of the `iterable` are expected to\\u001b[39;00m\\n\\u001b[1;32m    372\\u001b[0m \\u001b[38;5;124;03m    be iterables as well and will be unpacked as arguments. Hence\\u001b[39;00m\\n\\u001b[1;32m    373\\u001b[0m \\u001b[38;5;124;03m    `func` and (a, b) becomes func(a, b).\\u001b[39;00m\\n\\u001b[1;32m    374\\u001b[0m \\u001b[38;5;124;03m    '''\\u001b[39;00m\\n\\u001b[0;32m--> 375\\u001b[0m     \\u001b[38;5;28;01mreturn\\u001b[39;00m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m_map_async\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mfunc\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43miterable\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mstarmapstar\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mchunksize\\u001b[49m\\u001b[43m)\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mget\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43m)\\u001b[49m\\n\",\n      \"File \\u001b[0;32m~/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py:768\\u001b[0m, in \\u001b[0;36mApplyResult.get\\u001b[0;34m(self, timeout)\\u001b[0m\\n\\u001b[1;32m    767\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21mget\\u001b[39m(\\u001b[38;5;28mself\\u001b[39m, timeout\\u001b[38;5;241m=\\u001b[39m\\u001b[38;5;28;01mNone\\u001b[39;00m):\\n\\u001b[0;32m--> 768\\u001b[0m     \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mwait\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mtimeout\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    769\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mready():\\n\\u001b[1;32m    770\\u001b[0m         \\u001b[38;5;28;01mraise\\u001b[39;00m \\u001b[38;5;167;01mTimeoutError\\u001b[39;00m\\n\",\n      \"File \\u001b[0;32m~/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py:765\\u001b[0m, in \\u001b[0;36mApplyResult.wait\\u001b[0;34m(self, timeout)\\u001b[0m\\n\\u001b[1;32m    764\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21mwait\\u001b[39m(\\u001b[38;5;28mself\\u001b[39m, timeout\\u001b[38;5;241m=\\u001b[39m\\u001b[38;5;28;01mNone\\u001b[39;00m):\\n\\u001b[0;32m--> 765\\u001b[0m     \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m_event\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mwait\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mtimeout\\u001b[49m\\u001b[43m)\\u001b[49m\\n\",\n      \"File \\u001b[0;32m~/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/threading.py:629\\u001b[0m, in \\u001b[0;36mEvent.wait\\u001b[0;34m(self, timeout)\\u001b[0m\\n\\u001b[1;32m    627\\u001b[0m signaled \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_flag\\n\\u001b[1;32m    628\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m signaled:\\n\\u001b[0;32m--> 629\\u001b[0m     signaled \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m_cond\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mwait\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mtimeout\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    630\\u001b[0m \\u001b[38;5;28;01mreturn\\u001b[39;00m signaled\\n\",\n      \"File \\u001b[0;32m~/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/threading.py:327\\u001b[0m, in \\u001b[0;36mCondition.wait\\u001b[0;34m(self, timeout)\\u001b[0m\\n\\u001b[1;32m    325\\u001b[0m \\u001b[38;5;28;01mtry\\u001b[39;00m:    \\u001b[38;5;66;03m# restore state no matter what (e.g., KeyboardInterrupt)\\u001b[39;00m\\n\\u001b[1;32m    326\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m timeout \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m:\\n\\u001b[0;32m--> 327\\u001b[0m         \\u001b[43mwaiter\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43macquire\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    328\\u001b[0m         gotit \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;01mTrue\\u001b[39;00m\\n\\u001b[1;32m    329\\u001b[0m     \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\",\n      \"\\u001b[0;31mKeyboardInterrupt\\u001b[0m: \"\n     ]\n    }\n   ],\n   \"source\": [\n    \"inputs1, truths = tools.data.create_XY_pairs (tf_dataset_path+\\\"test1.tfrecord\\\")\\n\",\n    \"tp1, fp1, fn1, mask1 = evals.eval_tools.get_mask(truths, predictions_1, multiprocess_size=batch_size)\\n\",\n    \"print (\\\"Scoring 1 done\\\")\\n\",\n    \"\\n\",\n    \"inputs2, truths = tools.data.create_XY_pairs (tf_dataset_path+\\\"test2.tfrecord\\\")\\n\",\n    \"tp2, fp2, fn2, mask2 = evals.eval_tools.get_mask(truths, predictions_2, multiprocess_size=batch_size)\\n\",\n    \"print (\\\"Scoring 2 done\\\")\\n\",\n    \"\\n\",\n    \"inputs3, truths = tools.data.create_XY_pairs (tf_dataset_path+\\\"test3.tfrecord\\\")\\n\",\n    \"tp3, fp3, fn3, mask3 = evals.eval_tools.get_mask(truths, predictions_3, multiprocess_size=batch_size)\\n\",\n    \"print (\\\"Scoring 3 done\\\")\\n\",\n    \"\\n\",\n    \"inputs4, truths = tools.data.create_XY_pairs (tf_dataset_path+\\\"test4.tfrecord\\\")\\n\",\n    \"tp4, fp4, fn4, mask4 = evals.eval_tools.get_mask(truths, predictions_4, multiprocess_size=batch_size)\\n\",\n    \"print (\\\"Scoring 4 done\\\")\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 16,\n   \"id\": \"78e7ad9a\",\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"Histogram data for 1 created\\n\",\n      \"Histogram data for 2 created\\n\",\n      \"Histogram data for 3 created\\n\",\n      \"Histogram data for 4 trail_length created\\n\"\n     ]\n    }\n   ],\n   \"source\": [\n    \"NN_detected_asteroids_1, \\\\\\n\",\n    \"true_asteroids_1 = evals.eval_tools.NN_comparation_histogram_data (predictions_1,\\n\",\n    \"                                                                   val_index_path,\\n\",\n    \"                                                                   repo_path,\\n\",\n    \"                                                                   collection+\\\"single_frame_injection_01\\\",\\n\",\n    \"                                                                   column_name=[\\\"mag\\\",\\\"trail_length\\\"],\\n\",\n    \"                                                                   multiprocess_size=batch_size)\\n\",\n    \"NN_detected_asteroids_1m = NN_detected_asteroids_1[:,0]\\n\",\n    \"NN_detected_asteroids_1t = NN_detected_asteroids_1[:,1]\\n\",\n    \"print (\\\"Histogram data for 1 created\\\")\\n\",\n    \"NN_detected_asteroids_2, \\\\\\n\",\n    \"true_asteroids_2 = evals.eval_tools.NN_comparation_histogram_data (predictions_2,\\n\",\n    \"                                                                   val_index_path,\\n\",\n    \"                                                                   repo_path,\\n\",\n    \"                                                                   collection+\\\"single_frame_injection_02\\\",\\n\",\n    \"                                                                   column_name=\\\"trail_length\\\",\\n\",\n    \"                                                                   multiprocess_size=batch_size)\\n\",\n    \"print (\\\"Histogram data for 2 created\\\")\\n\",\n    \"NN_detected_asteroids_3, \\\\\\n\",\n    \"true_asteroids_3 = evals.eval_tools.NN_comparation_histogram_data (predictions_3,\\n\",\n    \"                                                                   val_index_path,\\n\",\n    \"                                                                   repo_path,\\n\",\n    \"                                                                   collection+\\\"single_frame_injection_03\\\",\\n\",\n    \"                                                                   column_name=\\\"trail_length\\\",\\n\",\n    \"                                                                   multiprocess_size=batch_size)\\n\",\n    \"print (\\\"Histogram data for 3 created\\\")\\n\",\n    \"NN_detected_asteroids_4, \\\\\\n\",\n    \"true_asteroids_4 = evals.eval_tools.NN_comparation_histogram_data (predictions_4,\\n\",\n    \"                                                                   val_index_path,\\n\",\n    \"                                                                   repo_path,\\n\",\n    \"                                                                   collection+\\\"single_frame_injection_04\\\",\\n\",\n    \"                                                                   column_name=\\\"trail_length\\\",\\n\",\n    \"                                                                   multiprocess_size=batch_size)\\n\",\n    \"print (\\\"Histogram data for 4 created\\\")\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 19,\n   \"id\": \"ce922494\",\n   \"metadata\": {},\n   \"outputs\": [\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"LSST stack prediction 2 created\\n\",\n      \"LSST stack prediction 3 created\\n\",\n      \"LSST stack prediction 4 created\\n\"\n     ]\n    }\n   ],\n   \"source\": [\n    \"LSST_stack_detected_asteroids_1= evals.eval_tools.LSST_stack_comparation_histogram_data(repo_path,\\n\",\n    \"                                                                                        collection+\\\"single_frame_injection_01\\\",\\n\",\n    \"                                                                                        val_index_path,\\n\",\n    \"                                                                                        multiprocess_size=batch_size,\\n\",\n    \"                                                                                        column_name=[\\\"mag\\\",\\\"trail_length\\\"])\\n\",\n    \"\\n\",\n    \"LSST_stack_detected_asteroids_1m = LSST_stack_detected_asteroids_1[:,0]\\n\",\n    \"LSST_stack_detected_asteroids_1t = LSST_stack_detected_asteroids_1[:,1]\\n\",\n    \"print (\\\"LSST stack prediction 1 created\\\")\\n\",\n    \"LSST_stack_detected_asteroids_2= evals.eval_tools.LSST_stack_comparation_histogram_data(repo_path,\\n\",\n    \"                                                                                        collection+\\\"single_frame_injection_02\\\",\\n\",\n    \"                                                                                        val_index_path,\\n\",\n    \"                                                                                        multiprocess_size=batch_size,\\n\",\n    \"                                                                                        column_name=\\\"trail_length\\\")\\n\",\n    \"print (\\\"LSST stack prediction 2 created\\\")\\n\",\n    \"LSST_stack_detected_asteroids_3= evals.eval_tools.LSST_stack_comparation_histogram_data(repo_path,\\n\",\n    \"                                                                                        collection+\\\"single_frame_injection_03\\\",\\n\",\n    \"                                                                                        val_index_path,\\n\",\n    \"                                                                                        multiprocess_size=batch_size,\\n\",\n    \"                                                                                        column_name=\\\"trail_length\\\")\\n\",\n    \"print (\\\"LSST stack prediction 3 created\\\")\\n\",\n    \"LSST_stack_detected_asteroids_4= evals.eval_tools.LSST_stack_comparation_histogram_data(repo_path,\\n\",\n    \"                                                                                        collection+\\\"single_frame_injection_04\\\",\\n\",\n    \"                                                                                        val_index_path,\\n\",\n    \"                                                                                        multiprocess_size=batch_size,\\n\",\n    \"                                                                                        column_name=\\\"trail_length\\\")\\n\",\n    \"print (\\\"LSST stack prediction 4 created\\\")\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 10,\n   \"id\": \"4a976133\",\n   \"metadata\": {\n    \"scrolled\": false\n   },\n   \"outputs\": [],\n   \"source\": [\n    \"fig_1m = plot_magnitude_histogram (NN_detected_asteroids_1m, LSST_stack_detected_asteroids_1m, true_asteroids_1m)\\n\",\n    \"tp=tp1.sum()\\n\",\n    \"fp=fp1.sum()\\n\",\n    \"fn=fn1.sum()\\n\",\n    \"print (\\\"True Positives:\\\", int(tp),\\\"False Positives:\\\", int(fp), \\\"False Negatives:\\\", int(fn))\\n\",\n    \"print (\\\"F1 score\\\", evals.eval_tools.f1_score (tp,fp,fn), \\n\",\n    \"       \\\"\\\\nPrecision\\\", evals.eval_tools.precision (tp,fp,fn), \\n\",\n    \"       \\\"\\\\nRecall\\\", evals.eval_tools.recall(tp,fp,fn))\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 11,\n   \"id\": \"c85645dc\",\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"fig_1t = plot_trail_histogram (NN_detected_asteroids_1t, LSST_stack_detected_asteroids_1t, true_asteroids_1t)\\n\",\n    \"minmag1, maxmag1 = get_magnitude_bin (repo_path, collection+\\\"single_frame_injection_01\\\")\\n\",\n    \"_ = fig_1t.suptitle(\\\"Magnitude: \\\"+str(round(minmag1, 1))+\\\" - \\\"+str(round(maxmag1, 1)))\\n\",\n    \"tp=tp1.sum()\\n\",\n    \"fp=fp1.sum()\\n\",\n    \"fn=fn1.sum()\\n\",\n    \"print (\\\"True Positives:\\\", int(tp),\\\"False Positives:\\\", int(fp), \\\"False Negatives:\\\", int(fn))\\n\",\n    \"print (\\\"F1 score\\\", evals.eval_tools.f1_score (tp,fp,fn), \\n\",\n    \"       \\\"\\\\nPrecision\\\", evals.eval_tools.precision (tp,fp,fn), \\n\",\n    \"       \\\"\\\\nRecall\\\", evals.eval_tools.recall(tp,fp,fn))\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 12,\n   \"id\": \"96aa164d\",\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"fig_2 = plot_trail_histogram (NN_detected_asteroids_2, LSST_stack_detected_asteroids_2, true_asteroids_2)\\n\",\n    \"minmag2, maxmag2 = get_magnitude_bin (repo_path, collection+\\\"single_frame_injection_02\\\")\\n\",\n    \"_ = fig_2.suptitle(\\\"Magnitude: \\\"+str(round(minmag2, 1))+\\\" - \\\"+str(round(maxmag2, 1)))\\n\",\n    \"tp=tp2.sum()\\n\",\n    \"fp=fp2.sum()\\n\",\n    \"fn=fn2.sum()\\n\",\n    \"print (\\\"True Positives:\\\", int(tp),\\\"False Positives:\\\", int(fp), \\\"False Negatives:\\\", int(fn))\\n\",\n    \"print (\\\"F1 score\\\", evals.eval_tools.f1_score (tp,fp,fn), \\n\",\n    \"       \\\"\\\\nPrecision\\\", evals.eval_tools.precision (tp,fp,fn), \\n\",\n    \"       \\\"\\\\nRecall\\\", evals.eval_tools.recall(tp,fp,fn))\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 13,\n   \"id\": \"f7cd2042\",\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"fig_3 = plot_trail_histogram (NN_detected_asteroids_3, LSST_stack_detected_asteroids_3, true_asteroids_3)\\n\",\n    \"minmag3, maxmag3 = get_magnitude_bin (repo_path, collection+\\\"single_frame_injection_03\\\")\\n\",\n    \"_ = fig_3.suptitle(\\\"Magnitude: \\\"+str(round(minmag3, 1))+\\\" - \\\"+str(round(maxmag3, 1)))\\n\",\n    \"tp=tp3.sum()\\n\",\n    \"fp=fp3.sum()\\n\",\n    \"fn=fn3.sum()\\n\",\n    \"print (\\\"True Positives:\\\", int(tp),\\\"False Positives:\\\", int(fp), \\\"False Negatives:\\\", int(fn))\\n\",\n    \"print (\\\"F1 score\\\", evals.eval_tools.f1_score (tp,fp,fn), \\n\",\n    \"       \\\"\\\\nPrecision\\\", evals.eval_tools.precision (tp,fp,fn), \\n\",\n    \"       \\\"\\\\nRecall\\\", evals.eval_tools.recall(tp,fp,fn))\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 14,\n   \"id\": \"0309eb55\",\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"fig_4 = plot_trail_histogram (NN_detected_asteroids_4, LSST_stack_detected_asteroids_4, true_asteroids_4)\\n\",\n    \"minmag4, maxmag4 = get_magnitude_bin (repo_path, collection+\\\"single_frame_injection_04\\\")\\n\",\n    \"_ = fig_4.suptitle(\\\"Magnitude: \\\"+str(round(minmag4, 1))+\\\" - \\\"+str(round(maxmag4, 1)))\\n\",\n    \"tp=tp4.sum()\\n\",\n    \"fp=fp4.sum()\\n\",\n    \"fn=fn4.sum()\\n\",\n    \"print (\\\"True Positives:\\\", int(tp),\\\"False Positives:\\\", int(fp), \\\"False Negatives:\\\", int(fn))\\n\",\n    \"print (\\\"F1 score\\\", evals.eval_tools.f1_score (tp,fp,fn), \\n\",\n    \"       \\\"\\\\nPrecision\\\", evals.eval_tools.precision (tp,fp,fn), \\n\",\n    \"       \\\"\\\\nRecall\\\", evals.eval_tools.recall(tp,fp,fn))\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 15,\n   \"id\": \"0b8356f6\",\n   \"metadata\": {\n    \"scrolled\": false\n   },\n   \"outputs\": [],\n   \"source\": [\n    \"i=1\\n\",\n    \"fig, ax = plt.subplots(4, 2, figsize=(10,35))\\n\",\n    \"ax[0,1] = plot_mask_on_axis (mask1[i], ax[0,1])\\n\",\n    \"ax[0,0] = plot_input_on_axis (inputs1[i], ax[0,0])\\n\",\n    \"ax[0,0].set_ylabel(\\\"Magnitude: \\\"+str(round(minmag1, 1))+\\\" - \\\"+str(round(maxmag1, 1)))\\n\",\n    \"\\n\",\n    \"ax[1,1] = plot_mask_on_axis (mask2[i], ax[1,1])\\n\",\n    \"ax[1,0] = plot_input_on_axis (inputs2[i], ax[1,0])\\n\",\n    \"ax[1,0].set_ylabel(\\\"Magnitude: \\\"+str(round(minmag2, 1))+\\\" - \\\"+str(round(maxmag2, 1)))\\n\",\n    \"\\n\",\n    \"ax[2,1] = plot_mask_on_axis (mask3[i], ax[2,1])\\n\",\n    \"ax[2,0] = plot_input_on_axis (inputs3[i], ax[2,0])\\n\",\n    \"ax[2,0].set_ylabel(\\\"Magnitude: \\\"+str(round(minmag3, 1))+\\\" - \\\"+str(round(maxmag3, 1)))\\n\",\n    \"\\n\",\n    \"ax[3,1] = plot_mask_on_axis (mask3[i], ax[3,1])\\n\",\n    \"ax[3,0] = plot_input_on_axis (inputs3[i], ax[3,0])\\n\",\n    \"ax[3,0].set_ylabel(\\\"Magnitude: \\\"+str(round(minmag4, 1))+\\\" - \\\"+str(round(maxmag4, 1)))\\n\",\n    \"fig.tight_layout()\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"id\": \"6b646dbd\",\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": []\n  }\n ],\n \"metadata\": {\n  \"kernelspec\": {\n   \"display_name\": \"Karlo's LSST Stack\",\n   \"language\": \"python\",\n   \"name\": \"kmrakovcic_lsststack\"\n  },\n  \"language_info\": {\n   \"codemirror_mode\": {\n    \"name\": \"ipython\",\n    \"version\": 3\n   },\n   \"file_extension\": \".py\",\n   \"mimetype\": \"text/x-python\",\n   \"name\": \"python\",\n   \"nbconvert_exporter\": \"python\",\n   \"pygments_lexer\": \"ipython3\",\n   \"version\": \"3.11.9\"\n  }\n },\n \"nbformat\": 4,\n \"nbformat_minor\": 5\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/notebooks/Inspect_model.ipynb b/notebooks/Inspect_model.ipynb
--- a/notebooks/Inspect_model.ipynb	(revision f83ae365b622be79c5eae4931afbdae889f87551)
+++ b/notebooks/Inspect_model.ipynb	(date 1718096926625)
@@ -347,16 +347,16 @@
      "evalue": "",
      "output_type": "error",
      "traceback": [
-      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
-      "\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
-      "Cell \u001b[0;32mIn[10], line 2\u001b[0m\n\u001b[1;32m      1\u001b[0m inputs1, truths \u001b[38;5;241m=\u001b[39m tools\u001b[38;5;241m.\u001b[39mdata\u001b[38;5;241m.\u001b[39mcreate_XY_pairs (tf_dataset_path\u001b[38;5;241m+\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mtest1.tfrecord\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m----> 2\u001b[0m tp1, fp1, fn1, mask1 \u001b[38;5;241m=\u001b[39m \u001b[43mevals\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43meval_tools\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mget_mask\u001b[49m\u001b[43m(\u001b[49m\u001b[43mtruths\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mpredictions_1\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmultiprocess_size\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mbatch_size\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m      3\u001b[0m \u001b[38;5;28mprint\u001b[39m (\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mScoring 1 done\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m      5\u001b[0m inputs2, truths \u001b[38;5;241m=\u001b[39m tools\u001b[38;5;241m.\u001b[39mdata\u001b[38;5;241m.\u001b[39mcreate_XY_pairs (tf_dataset_path\u001b[38;5;241m+\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mtest2.tfrecord\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
-      "File \u001b[0;32m~/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py:239\u001b[0m, in \u001b[0;36mget_mask\u001b[0;34m(truths, predictions, multiprocess_size)\u001b[0m\n\u001b[1;32m    237\u001b[0m     parameters \u001b[38;5;241m=\u001b[39m [(truths[i], predictions[i]) \u001b[38;5;28;01mfor\u001b[39;00m i \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(truths\u001b[38;5;241m.\u001b[39mshape[\u001b[38;5;241m0\u001b[39m])]\n\u001b[1;32m    238\u001b[0m     \u001b[38;5;28;01mwith\u001b[39;00m multiprocessing\u001b[38;5;241m.\u001b[39mPool(multiprocess_size) \u001b[38;5;28;01mas\u001b[39;00m pool:\n\u001b[0;32m--> 239\u001b[0m         results \u001b[38;5;241m=\u001b[39m \u001b[43mpool\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mstarmap\u001b[49m\u001b[43m(\u001b[49m\u001b[43mget_one_image_mask\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mparameters\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    240\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m    241\u001b[0m     results \u001b[38;5;241m=\u001b[39m [\u001b[38;5;28;01mNone\u001b[39;00m] \u001b[38;5;241m*\u001b[39m truths\u001b[38;5;241m.\u001b[39mshape[\u001b[38;5;241m0\u001b[39m]\n",
-      "File \u001b[0;32m~/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py:375\u001b[0m, in \u001b[0;36mPool.starmap\u001b[0;34m(self, func, iterable, chunksize)\u001b[0m\n\u001b[1;32m    369\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mstarmap\u001b[39m(\u001b[38;5;28mself\u001b[39m, func, iterable, chunksize\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mNone\u001b[39;00m):\n\u001b[1;32m    370\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m'''\u001b[39;00m\n\u001b[1;32m    371\u001b[0m \u001b[38;5;124;03m    Like `map()` method but the elements of the `iterable` are expected to\u001b[39;00m\n\u001b[1;32m    372\u001b[0m \u001b[38;5;124;03m    be iterables as well and will be unpacked as arguments. Hence\u001b[39;00m\n\u001b[1;32m    373\u001b[0m \u001b[38;5;124;03m    `func` and (a, b) becomes func(a, b).\u001b[39;00m\n\u001b[1;32m    374\u001b[0m \u001b[38;5;124;03m    '''\u001b[39;00m\n\u001b[0;32m--> 375\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_map_async\u001b[49m\u001b[43m(\u001b[49m\u001b[43mfunc\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43miterable\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mstarmapstar\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mchunksize\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mget\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n",
-      "File \u001b[0;32m~/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py:768\u001b[0m, in \u001b[0;36mApplyResult.get\u001b[0;34m(self, timeout)\u001b[0m\n\u001b[1;32m    767\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mget\u001b[39m(\u001b[38;5;28mself\u001b[39m, timeout\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mNone\u001b[39;00m):\n\u001b[0;32m--> 768\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mwait\u001b[49m\u001b[43m(\u001b[49m\u001b[43mtimeout\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    769\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mready():\n\u001b[1;32m    770\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mTimeoutError\u001b[39;00m\n",
-      "File \u001b[0;32m~/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py:765\u001b[0m, in \u001b[0;36mApplyResult.wait\u001b[0;34m(self, timeout)\u001b[0m\n\u001b[1;32m    764\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mwait\u001b[39m(\u001b[38;5;28mself\u001b[39m, timeout\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mNone\u001b[39;00m):\n\u001b[0;32m--> 765\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_event\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mwait\u001b[49m\u001b[43m(\u001b[49m\u001b[43mtimeout\u001b[49m\u001b[43m)\u001b[49m\n",
-      "File \u001b[0;32m~/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/threading.py:629\u001b[0m, in \u001b[0;36mEvent.wait\u001b[0;34m(self, timeout)\u001b[0m\n\u001b[1;32m    627\u001b[0m signaled \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_flag\n\u001b[1;32m    628\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m signaled:\n\u001b[0;32m--> 629\u001b[0m     signaled \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_cond\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mwait\u001b[49m\u001b[43m(\u001b[49m\u001b[43mtimeout\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    630\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m signaled\n",
-      "File \u001b[0;32m~/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/threading.py:327\u001b[0m, in \u001b[0;36mCondition.wait\u001b[0;34m(self, timeout)\u001b[0m\n\u001b[1;32m    325\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:    \u001b[38;5;66;03m# restore state no matter what (e.g., KeyboardInterrupt)\u001b[39;00m\n\u001b[1;32m    326\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m timeout \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m--> 327\u001b[0m         \u001b[43mwaiter\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43macquire\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    328\u001b[0m         gotit \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mTrue\u001b[39;00m\n\u001b[1;32m    329\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n",
-      "\u001b[0;31mKeyboardInterrupt\u001b[0m: "
+      "\u001B[0;31m---------------------------------------------------------------------------\u001B[0m",
+      "\u001B[0;31mKeyboardInterrupt\u001B[0m                         Traceback (most recent call last)",
+      "Cell \u001B[0;32mIn[10], line 2\u001B[0m\n\u001B[1;32m      1\u001B[0m inputs1, truths \u001B[38;5;241m=\u001B[39m tools\u001B[38;5;241m.\u001B[39mdata\u001B[38;5;241m.\u001B[39mcreate_XY_pairs (tf_dataset_path\u001B[38;5;241m+\u001B[39m\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mtest1.tfrecord\u001B[39m\u001B[38;5;124m\"\u001B[39m)\n\u001B[0;32m----> 2\u001B[0m tp1, fp1, fn1, mask1 \u001B[38;5;241m=\u001B[39m \u001B[43mevals\u001B[49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43meval_tools\u001B[49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mget_mask\u001B[49m\u001B[43m(\u001B[49m\u001B[43mtruths\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43mpredictions_1\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43mmultiprocess_size\u001B[49m\u001B[38;5;241;43m=\u001B[39;49m\u001B[43mbatch_size\u001B[49m\u001B[43m)\u001B[49m\n\u001B[1;32m      3\u001B[0m \u001B[38;5;28mprint\u001B[39m (\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mScoring 1 done\u001B[39m\u001B[38;5;124m\"\u001B[39m)\n\u001B[1;32m      5\u001B[0m inputs2, truths \u001B[38;5;241m=\u001B[39m tools\u001B[38;5;241m.\u001B[39mdata\u001B[38;5;241m.\u001B[39mcreate_XY_pairs (tf_dataset_path\u001B[38;5;241m+\u001B[39m\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mtest2.tfrecord\u001B[39m\u001B[38;5;124m\"\u001B[39m)\n",
+      "File \u001B[0;32m~/Projects/LSST_Streak_Detection/notebooks/../evals/eval_tools.py:239\u001B[0m, in \u001B[0;36mget_mask\u001B[0;34m(truths, predictions, multiprocess_size)\u001B[0m\n\u001B[1;32m    237\u001B[0m     parameters \u001B[38;5;241m=\u001B[39m [(truths[i], predictions[i]) \u001B[38;5;28;01mfor\u001B[39;00m i \u001B[38;5;129;01min\u001B[39;00m \u001B[38;5;28mrange\u001B[39m(truths\u001B[38;5;241m.\u001B[39mshape[\u001B[38;5;241m0\u001B[39m])]\n\u001B[1;32m    238\u001B[0m     \u001B[38;5;28;01mwith\u001B[39;00m multiprocessing\u001B[38;5;241m.\u001B[39mPool(multiprocess_size) \u001B[38;5;28;01mas\u001B[39;00m pool:\n\u001B[0;32m--> 239\u001B[0m         results \u001B[38;5;241m=\u001B[39m \u001B[43mpool\u001B[49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mstarmap\u001B[49m\u001B[43m(\u001B[49m\u001B[43mget_one_image_mask\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43mparameters\u001B[49m\u001B[43m)\u001B[49m\n\u001B[1;32m    240\u001B[0m \u001B[38;5;28;01melse\u001B[39;00m:\n\u001B[1;32m    241\u001B[0m     results \u001B[38;5;241m=\u001B[39m [\u001B[38;5;28;01mNone\u001B[39;00m] \u001B[38;5;241m*\u001B[39m truths\u001B[38;5;241m.\u001B[39mshape[\u001B[38;5;241m0\u001B[39m]\n",
+      "File \u001B[0;32m~/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py:375\u001B[0m, in \u001B[0;36mPool.starmap\u001B[0;34m(self, func, iterable, chunksize)\u001B[0m\n\u001B[1;32m    369\u001B[0m \u001B[38;5;28;01mdef\u001B[39;00m \u001B[38;5;21mstarmap\u001B[39m(\u001B[38;5;28mself\u001B[39m, func, iterable, chunksize\u001B[38;5;241m=\u001B[39m\u001B[38;5;28;01mNone\u001B[39;00m):\n\u001B[1;32m    370\u001B[0m \u001B[38;5;250m    \u001B[39m\u001B[38;5;124;03m'''\u001B[39;00m\n\u001B[1;32m    371\u001B[0m \u001B[38;5;124;03m    Like `map()` method but the elements of the `iterable` are expected to\u001B[39;00m\n\u001B[1;32m    372\u001B[0m \u001B[38;5;124;03m    be iterables as well and will be unpacked as arguments. Hence\u001B[39;00m\n\u001B[1;32m    373\u001B[0m \u001B[38;5;124;03m    `func` and (a, b) becomes func(a, b).\u001B[39;00m\n\u001B[1;32m    374\u001B[0m \u001B[38;5;124;03m    '''\u001B[39;00m\n\u001B[0;32m--> 375\u001B[0m     \u001B[38;5;28;01mreturn\u001B[39;00m \u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43m_map_async\u001B[49m\u001B[43m(\u001B[49m\u001B[43mfunc\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43miterable\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43mstarmapstar\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43mchunksize\u001B[49m\u001B[43m)\u001B[49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mget\u001B[49m\u001B[43m(\u001B[49m\u001B[43m)\u001B[49m\n",
+      "File \u001B[0;32m~/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py:768\u001B[0m, in \u001B[0;36mApplyResult.get\u001B[0;34m(self, timeout)\u001B[0m\n\u001B[1;32m    767\u001B[0m \u001B[38;5;28;01mdef\u001B[39;00m \u001B[38;5;21mget\u001B[39m(\u001B[38;5;28mself\u001B[39m, timeout\u001B[38;5;241m=\u001B[39m\u001B[38;5;28;01mNone\u001B[39;00m):\n\u001B[0;32m--> 768\u001B[0m     \u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mwait\u001B[49m\u001B[43m(\u001B[49m\u001B[43mtimeout\u001B[49m\u001B[43m)\u001B[49m\n\u001B[1;32m    769\u001B[0m     \u001B[38;5;28;01mif\u001B[39;00m \u001B[38;5;129;01mnot\u001B[39;00m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39mready():\n\u001B[1;32m    770\u001B[0m         \u001B[38;5;28;01mraise\u001B[39;00m \u001B[38;5;167;01mTimeoutError\u001B[39;00m\n",
+      "File \u001B[0;32m~/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/multiprocessing/pool.py:765\u001B[0m, in \u001B[0;36mApplyResult.wait\u001B[0;34m(self, timeout)\u001B[0m\n\u001B[1;32m    764\u001B[0m \u001B[38;5;28;01mdef\u001B[39;00m \u001B[38;5;21mwait\u001B[39m(\u001B[38;5;28mself\u001B[39m, timeout\u001B[38;5;241m=\u001B[39m\u001B[38;5;28;01mNone\u001B[39;00m):\n\u001B[0;32m--> 765\u001B[0m     \u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43m_event\u001B[49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mwait\u001B[49m\u001B[43m(\u001B[49m\u001B[43mtimeout\u001B[49m\u001B[43m)\u001B[49m\n",
+      "File \u001B[0;32m~/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/threading.py:629\u001B[0m, in \u001B[0;36mEvent.wait\u001B[0;34m(self, timeout)\u001B[0m\n\u001B[1;32m    627\u001B[0m signaled \u001B[38;5;241m=\u001B[39m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39m_flag\n\u001B[1;32m    628\u001B[0m \u001B[38;5;28;01mif\u001B[39;00m \u001B[38;5;129;01mnot\u001B[39;00m signaled:\n\u001B[0;32m--> 629\u001B[0m     signaled \u001B[38;5;241m=\u001B[39m \u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43m_cond\u001B[49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mwait\u001B[49m\u001B[43m(\u001B[49m\u001B[43mtimeout\u001B[49m\u001B[43m)\u001B[49m\n\u001B[1;32m    630\u001B[0m \u001B[38;5;28;01mreturn\u001B[39;00m signaled\n",
+      "File \u001B[0;32m~/miniconda/envs/lsst-scipipe-8.0.0/lib/python3.11/threading.py:327\u001B[0m, in \u001B[0;36mCondition.wait\u001B[0;34m(self, timeout)\u001B[0m\n\u001B[1;32m    325\u001B[0m \u001B[38;5;28;01mtry\u001B[39;00m:    \u001B[38;5;66;03m# restore state no matter what (e.g., KeyboardInterrupt)\u001B[39;00m\n\u001B[1;32m    326\u001B[0m     \u001B[38;5;28;01mif\u001B[39;00m timeout \u001B[38;5;129;01mis\u001B[39;00m \u001B[38;5;28;01mNone\u001B[39;00m:\n\u001B[0;32m--> 327\u001B[0m         \u001B[43mwaiter\u001B[49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43macquire\u001B[49m\u001B[43m(\u001B[49m\u001B[43m)\u001B[49m\n\u001B[1;32m    328\u001B[0m         gotit \u001B[38;5;241m=\u001B[39m \u001B[38;5;28;01mTrue\u001B[39;00m\n\u001B[1;32m    329\u001B[0m     \u001B[38;5;28;01melse\u001B[39;00m:\n",
+      "\u001B[0;31mKeyboardInterrupt\u001B[0m: "
      ]
     }
    ],
